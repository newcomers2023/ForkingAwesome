<!DOCTYPE html>
<html>
<head>
    <title>Tic-Tac-Toe</title>
    <style>
        #game-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        #tic-tac-toe-game canvas {
            border: 1px solid black;
        }

        button {
            margin-top: 20px;
        }
    </style>
</head>
<body>
<div id="tic-tac-toe-game">
    <canvas id="game-canvas" width="300" height="300"></canvas>
    <button onclick="goToMainPage()">Back to Main Page</button>
</div>

<script>
        // Tic-Tac-Toe-Spiellogik

        var canvas = document.getElementById("game-canvas");
        var ctx = canvas.getContext("2d");
        var board = [
            ["", "", ""],
            ["", "", ""],
            ["", "", ""]
        ];
        var currentPlayer = "X";
        var gameEnded = false;

        function drawBoard() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            ctx.strokeStyle = "black";
            ctx.lineWidth = 2;

            // Vertikale Linien
            ctx.beginPath();
            ctx.moveTo(canvas.width / 3, 0);
            ctx.lineTo(canvas.width / 3, canvas.height);
            ctx.stroke();

            ctx.beginPath();
            ctx.moveTo((canvas.width / 3) * 2, 0);
            ctx.lineTo((canvas.width / 3) * 2, canvas.height);
            ctx.stroke();

            // Horizontale Linien
            ctx.beginPath();
            ctx.moveTo(0, canvas.height / 3);
            ctx.lineTo(canvas.width, canvas.height / 3);
            ctx.stroke();

            ctx.beginPath();
            ctx.moveTo(0, (canvas.height / 3) * 2);
            ctx.lineTo(canvas.width, (canvas.height / 3) * 2);
            ctx.stroke();

            // Symbole zeichnen
            ctx.font = "60px Arial";
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";

            for (var row = 0; row < 3; row++) {
                for (var col = 0; col < 3; col++) {
                    var symbol = board[row][col];
                    var x = (col + 0.5) * (canvas.width / 3);
                    var y = (row + 0.5) * (canvas.height / 3);
                    ctx.fillText(symbol, x, y);
                }
            }
        }

        function handleClick(event) {
            if (gameEnded) {
                return;
            }

            var rect = canvas.getBoundingClientRect();
            var x = event.clientX - rect.left;
            var y = event.clientY - rect.top;

            var col = Math.floor(x / (canvas.width / 3));
            var row = Math.floor(y / (canvas.height / 3));

            if (board[row][col] === "") {
                board[row][col] = currentPlayer;
                drawBoard();
                checkGameStatus();

                currentPlayer = currentPlayer === "X" ? "O" : "X";
            }
        }

        function checkGameStatus() {
            // Überprüfe die Gewinnbedingungen

            // Horizontal
            for (var row = 0; row < 3; row++) {
                if (
                    board[row][0] !== "" &&
                    board[row][0] === board[row][1] &&
                    board[row][0] === board[row][2]
                ) {
                    endGame(board[row][0]);
                    return;
                }
            }

            // Vertikal
            for (var col = 0; col < 3; col++) {
                if (
                    board[0][col] !== "" &&
                    board[0][col] === board[1][col] &&
                    board[0][col] === board[2][col]
                ) {
                    endGame(board[0][col]);
                    return;
                }
            }

            // Diagonal
            if (
                board[0][0] !== "" &&
                board[0][0] === board[1][1] &&
                board[0][0] === board[2][2]
            ) {
                endGame(board[0][0]);
                return;
            }

            if (
                board[0][2] !== "" &&
                board[0][2] === board[1][1] &&
                board[0][2] === board[2][0]
            ) {
                endGame(board[0][2]);
                return;
            }

            // Unentschieden
            if (!board.flat().includes("")) {
                endGame("tie");
                return;
            }
        }

        function endGame(winner) {
            gameEnded = true;
            var message = "";
            if (winner === "tie") {
                message = "It's a tie!";
            } else {
                message = "Player " + winner + " wins!";
            }
            alert(message);
            resetGame();
        }

        function resetGame() {
            board = [
                ["", "", ""],
                ["", "", ""],
                ["", "", ""]
            ];
            currentPlayer = "X";
            gameEnded = false;
            drawBoard();
        }

        function goToMainPage() {
            window.location.href = "MainPage.html";
        }

        // Klick-Event für das Spielfeld
        canvas.addEventListener("click", handleClick);

        // Spiel initialisieren
        drawBoard();
    </script>
</body>
</html>
